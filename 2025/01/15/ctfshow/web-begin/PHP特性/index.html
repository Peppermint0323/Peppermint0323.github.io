<!-- build time:Thu Jan 16 2025 19:13:33 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="笔记小破站" href="http://example.com/rss.xml"><link rel="alternate" type="application/atom+xml" title="笔记小破站" href="http://example.com/atom.xml"><link rel="alternate" type="application/json" title="笔记小破站" href="http://example.com/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><link rel="canonical" href="http://example.com/2025/01/15/ctfshow/web-begin/PHP%E7%89%B9%E6%80%A7/"><title>PHP特性 - web入门 - ctfshow | Peppermintの小窝 = 笔记小破站 = persistence</title><meta name="generator" content="Hexo 7.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">PHP特性</h1><div class="meta"><span class="item" title="创建时间：2025-01-15 20:08:46"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2025-01-15T20:08:46+08:00">2025-01-15</time></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Peppermintの小窝</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><img src="/asserts/1.jpg"></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ctfshow/" itemprop="item" rel="index" title="分类于 ctfshow"><span itemprop="name">ctfshow</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/ctfshow/web%E5%85%A5%E9%97%A8/" itemprop="item" rel="index" title="分类于 web入门"><span itemprop="name">web入门</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2025/01/15/ctfshow/web-begin/PHP%E7%89%B9%E6%80%A7/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Peppermint"><meta itemprop="description" content="persistence, "></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="笔记小破站"></span><div class="body md" itemprop="articleBody"><p>1.web89<br><img data-src="https://peppermint.com/ctf/web89-1.png" alt=""><br>得到 flag 的途径就是让 num 中包含数字，但又会被 preg_match 给过滤掉，可以用数组的形式使 preg_match 报错，达到绕过<img data-src="./PHP%e7%89%b9%e6%80%a7/2024-07-10-2016.47.57.png" alt=""></p><p>2.web90<br><img data-src="./PHP%e7%89%b9%e6%80%a7/2024-07-10-2016.53.41.png" alt=""><br>采用了强比较，intval 中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mi>a</mi><mi>s</mi><mi>e</mi><mtext>的位置是</mtext><mn>0</mn><mtext>的话，意味着进制将由数字的开头决定，可以采用</mtext><mn>4467</mn><mtext>的八进制或者十六进制来绕过</mtext></mrow><annotation encoding="application/x-tex">base的位置是0的话，意味着进制将由数字的开头决定，可以采用4467的八进制或者十六进制来绕过</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">b</span><span class="mord mathnormal">a</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">位</span><span class="mord cjk_fallback">置</span><span class="mord cjk_fallback">是</span><span class="mord">0</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">话</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">意</span><span class="mord cjk_fallback">味</span><span class="mord cjk_fallback">着</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">制</span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">由</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">字</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">开</span><span class="mord cjk_fallback">头</span><span class="mord cjk_fallback">决</span><span class="mord cjk_fallback">定</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">以</span><span class="mord cjk_fallback">采</span><span class="mord cjk_fallback">用</span><span class="mord">4</span><span class="mord">4</span><span class="mord">6</span><span class="mord">7</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">八</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">制</span><span class="mord cjk_fallback">或</span><span class="mord cjk_fallback">者</span><span class="mord cjk_fallback">十</span><span class="mord cjk_fallback">六</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">制</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">绕</span><span class="mord cjk_fallback">过</span></span></span></span> num===“4476”<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-10%2017.08.02.png" alt=""></p><p>3.web91<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-10%2017.15.12.png" alt=""><br>先是将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>m</mi><mi>d</mi><mtext>与</mtext><mi>p</mi><mi>h</mi><mi>p</mi><mtext>进行多行比较，有一次匹配对即可，再将其与</mtext><mi>p</mi><mi>h</mi><mi>p</mi><mtext>单行比较，通过换行符</mtext></mrow><annotation encoding="application/x-tex">cmd与php进行多行比较，有一次匹配对即可，再将其与php单行比较，通过换行符%0a，将其分割，使/^php</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">m</span><span class="mord mathnormal">d</span><span class="mord cjk_fallback">与</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">进</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">多</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">比</span><span class="mord cjk_fallback">较</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">有</span><span class="mord cjk_fallback">一</span><span class="mord cjk_fallback">次</span><span class="mord cjk_fallback">匹</span><span class="mord cjk_fallback">配</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">即</span><span class="mord cjk_fallback">可</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">再</span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">其</span><span class="mord cjk_fallback">与</span><span class="mord mathnormal">p</span><span class="mord mathnormal">h</span><span class="mord mathnormal">p</span><span class="mord cjk_fallback">单</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">比</span><span class="mord cjk_fallback">较</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span><span class="mord cjk_fallback">换</span><span class="mord cjk_fallback">行</span><span class="mord cjk_fallback">符</span></span></span></span>/im 成功执行，使 /^php$/ 执行失败：<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-10%2017.28.52.png" alt=""></p><p>4.web92<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2009.31.23.png" alt="">&lt;!-- {&quot;width&quot;:487} --&gt;<br>这是一个 num 和 4476 的弱比较，绕过只需将 4476 转换为 8 进制，由于有 intval 函数的存在，还需在数字前添加 0:<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2009.36.01.png" alt=""></p><p>5.web93<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2009.40.50.png" alt=""><br>比上题多过滤了字母，是为了防止 e 的应用，因为 php 中 e 可以不表示科学计数法，从而以带字母数字的形式通过弱比较，而 intval 也会在 e 处停下，这里仍使用八进制解法即可</p><p>6.web94<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2009.48.42.png" alt=""><br>strpos 函数查到 num 中的第一个 0 出现的位置，也就是说，直接输入 010574 的话，strpos 会返回 0，而！0 的结果就是 1，所以 0 绝对不能出现在第一个位置，可以采用 4476.0 或 %20010574 或 %0a010574</p><p>7.web95<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.03.13.png" alt=""><br>过滤了。号，%20 和 %0a 还能照常绕过<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.04.06.png" alt=""></p><p>8.web96<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.10.54.png" alt=""><br>在 php 中./ 表示当前目录，既可以绕过弱比较，又可以正确输出 flag<br>也可以使用 php://filter 伪协议，通过 base64 编码获取 flag<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.14.43.png" alt=""></p><p>9.web97<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.18.22.png" alt=""><br>post 两个变量使其内容不等又是 md5 值相等，很显然是构造数组，md5 面对数组会返回 null 值<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.19.28.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.19.33.png" alt=""></p><p>10.web98<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2010.44.10.png" alt=""><br>运用了 php 中的三元运算符和 &amp; 地址引用，改换代码如下：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2011.24.09.png" alt="">&lt;!-- {&quot;width&quot;:326} --&gt;<br>get 随便传参就行，改为 post<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2011.22.58.png" alt=""><br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2011.21.48.png" alt=""></p><p>11.web99<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.11.39.png" alt=""><br>in_array 的第三个参数没有被设置，说明 n 和 allow 数组中的值会进行弱比较，根据 file_put_content 函数，写入 php 文件，由 content 写入 php 代码：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.11.10.png" alt=""><br>查看目录：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.09.29.png" alt=""><br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.09.50.png" alt=""></p><p>12.web100<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.24.20.png" alt=""><br>v0 需要是大于 0 的数数字，由于运算符优先性，= 比 and 优先，所以 v1 大于 0 即可，v2 中不能含有；而 v3 必须含有；<br>拼接起来的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mn>2</mn><mi>c</mi><mi>t</mi><mi>f</mi><mi>s</mi><mi>h</mi><mi>o</mi><mi>w</mi></mrow><annotation encoding="application/x-tex">v2ctfshow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord">2</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord mathnormal">s</span><span class="mord mathnormal">h</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.02691em">w</span></span></span></span>v3 可以将中间的字符注释掉，这样只需要由 v2 输出 $ctfshow 就行，使用 var_dump 或者 print_r 输出<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.39.49.png" alt=""><br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.39.43.png" alt=""><br>0x2d 用 - 代替就能得到 flag 字符串了</p><p>13.web101<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2015.48.21.png" alt=""><br>题目中给出了提示，说 flag 在 ctfshow 的类中<br>了解到可以用 reflectionclass 建立反射类来获取数据元的信息<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2016.09.02.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2016.09.07.png" alt=""></p><p>14.web102<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2016.12.04.png" alt=""><br>其中 s 是删除了 v2 的前两个得到的，将作为 v1 的参数来获得 str 的表达式，其中，v2 应为一句话木马，最后使用 v3 将其作为文件传上去<br>其中，v2 必须是数字或者带 e 的数字，通过将代码 base64 编码，转 ascii 码再 16 进制转换，成功得预期数字字符串：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.15.00.png" alt="">&lt;!-- {&quot;width&quot;:288} --&gt;<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2017.32.45.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-11%2017.32.51.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2009.34.11.png" alt="">&lt;!-- {&quot;width&quot;:487} --&gt;</p><p>15.web103<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.20.03.png" alt=""><br>比上题多过滤了 str 变量中 php 的部分，不影响 v3，所以照常使用 php 伪协议，文件中的命令 &lt;?php 一直是用 &lt;?= 来绕过，因为带 php 构造不出预期的字符<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.19.39.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.19.29.png" alt=""> &lt;!-- {&quot;width&quot;:487} --&gt;</p><p>16.web104<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.28.35.png" alt=""><br>与 md5 同理，shal 也无法处理数组<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.28.51.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.28.45.png" alt=""></p><p>17.web105<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.34.07.png" alt=""><br>考察变量覆盖和 die 函数的特性，要绕过前面两个 die 函数，先覆盖 get：<br>使 suces 的地址指向 flag<br>再覆盖 post：<br>由于写的是 error=suces，不会通过强比较，但是 error 的地址又能指向 flag<br>这样，无论是剩下的哪个 die 都能输出 flag 的内容，由于 post 没有 flag=flag<br>所以先 die 了 error（die 是停止运行并输出内容）：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2010.48.13.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2011.03.42.png" alt=""></p><p>18.web106<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2011.08.38.png" alt=""><br>和 web104 类似，多了 v1 和 v2 的比较，还是用数组即可：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2011.09.28.png" alt=""></p><p>19.web107<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2011.13.09.png" alt=""><br>parse_str 函数将解析 v1 中的变量，由于下面的 if 判断语句得出，应该使 v1=flag；而后与 v3 的 md5 值比较，这里我们直接使 v3 的 md5 值为 null，这样 v2 [‘flag’] 也为 null 就能输出 flag<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2011.32.37.png" alt=""></p><p>20.web108<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.30.48.png" alt=""><br>strrev 函数有着倒序的作用，0x36d 是 16 进制，转换为 10 进制就是 877，由于倒序，传入为 778 即可，ereg 函数用来匹配字符，所以 c 中需要字母可以通过截断符 %00 来防止因为有数字返回 false，同样，弱比较可以通过数字末尾带字母的方式匹配成功<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.34.39.png" alt=""></p><p>21.web109<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.43.53.png" alt=""><br>看到 new 想到建立反射类<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.46.14.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.46.19.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.49.28.png" alt=""></p><p>22.web110<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.53.59.png" alt=""><br>学习了一手佬的 wp，了解到还有 FilesystemIterator 这种迭代器能够差目录，配合上 getcwd () 函数，找到文件<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2014.59.28.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.07.34.png" alt=""></p><p>23.web111<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.16.25.png" alt=""><br>看到题目定义了一个 getFlag 的函数，按照 preg_match 的限制 v1 应该为 ctfshow, 但是通过函数的作用，v2 不能直接输入，因为会受到内部函数无法调用外部变量的影响，所以采用了 GLOBAL 常量数组，将其变为全局变量<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.20.50.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.20.56.png" alt=""></p><p>24.web112<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.54.20.png" alt=""><br>题目先是通过 is_file 函数判断是否为一个文件，然后用 filter 函数来进行过滤，发现没有过滤 php，考虑使用 php 伪协议来读取文件<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.57.36.png" alt=""><br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2015.57.41.png" alt=""></p><p>25.web113<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2016.18.23.png" alt=""><br>发现过滤了 filter，那么 php 伪协议就不能用了，了解到，可以重复多次输入 /prof/self/root 这个根目录表达方式来超过 is_file 函数的输入限制，让其返回 false，还可以通过 zlib 来绕过<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2016.21.44.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2016.19.40.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2016.19.44.png" alt=""> &lt;!-- {&quot;width&quot;:337} --&gt;</p><p>26.web114<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2016.58.57.png" alt=""><br>把上题使用的 compress 和 root 都过滤了，但发现 filter 反而没有，直接使用 php://filter 伪协议：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2017.01.00.png" alt=""></p><p>27.web115<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2017.14.47.png" alt=""><br>首先，会过滤掉 0x，0，.,e，+ 这几个通过进制变换得到的东西<br>随后，通过 is_numeric,trim,filter 函数来判断，其中 trim () 函数会去掉 num 里的 %0a %0b %0d %20 %09，只有换页符 %0c 不会，其次，!== 是强比较，会比较数据类型，字符串肯定不会等于 36<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-12%2017.18.09.png" alt=""></p><p>28.web123<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2009.42.40.png" alt=""><br>可以看到，想要得到 flag 有两种方式，一种是通过 c，一种是通过 fl0g，但前面的代码已经用！isset 的方式将 fl0g 给否决掉了，只能 post fun，而且需要含有 CTF_SHOW 和 CTF_SHOW.COM，由于 php 特性，导致 +，. ，[都会被转换成_，但 [被转化之后，后面的符号会保持不变所以构造 payload<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2009.52.04.png" alt=""></p><p>29.web125<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2010.11.57.png" alt=""><br>过滤了一些用法，要找到不含上述符合的函数来读取，想到 highlight_file 绕过<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2010.17.12.png" alt=""></p><p>30.web126<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2010.22.52.png" alt=""><br>这里没什么思路，参考了一下 wp，了解到 assert 这个断言函数，通过断言引用了<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mtext>的</mtext></mrow><annotation encoding="application/x-tex">a的</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">a</span><span class="mord cjk_fallback">的</span></span></span></span>_SERVER 方式，将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mtext>变成了数组来传递</mtext></mrow><annotation encoding="application/x-tex">a变成了数组来传递</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal">a</span><span class="mord cjk_fallback">变</span><span class="mord cjk_fallback">成</span><span class="mord cjk_fallback">了</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">组</span><span class="mord cjk_fallback">来</span><span class="mord cjk_fallback">传</span><span class="mord cjk_fallback">递</span></span></span></span> fl0g，成功绕过了 $_GET 对于 fl0g 的限制，从而得到 flag<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2010.47.35.png" alt=""></p><p>31.web127<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2010.57.52.png" alt=""><br>waf 函数获得 $url 中的脚本信息，利用 extracr 函数转化为 get 请求，由于过滤了_，所以用 php 特性，将_用空格来代替，构造 payload：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2011.09.31.png" alt=""></p><p>32.web128<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2011.26.08.png" alt="">&lt;!-- {&quot;width&quot;:645} --&gt;<br>看到 var_dump 的参数需要经过两次函数回调的变换，而且 f1 还不能含有字母数字，看了 wp，还真是骚操作，用_() 来代替 gettext () 函数，其作用是原封不动输出参数，符合我们的要求，还加上 get_defined_vars () 函数，用于返回所有已定义变量构成的数组：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2011.33.12.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2011.33.17.png" alt=""></p><p>33.web129<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2014.34.11.png" alt=""><br>stripos 检索 ctfshow 的位置，需要大于 0，还要考虑 readfile 函数，采用目录穿越的操作构造 /../ 来穿越目录：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2014.45.32.png" alt=""></p><p>34.web130<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2014.52.53.png" alt=""><br>pre_match 针对 ctfshow 字符串的前面做出了过滤，却没有关注后面，直接输入 ctfshow 或者后面加字符都可以绕过<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2015.12.28.png" alt=""></p><p>35.web131<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2015.16.02.png" alt=""><br>在 ctfshow 前面多了 36D，运用正则表达溢出绕过 preg_match 函数，根据题目给出的提示，写了 25 万次 very<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2016.12.04.png" alt=""></p><p>34.web132<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2016.41.12.png" alt=""><br>打开题目发现是个网页，网页源码没发现什么有价值的东西，通过 dirsearch 去扫描后台目录<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2016.37.36.png" alt=""><br>抓到了 admin 和 asserts，进入 admin 页面，发现源码<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2016.38.19.png" alt=""><br>三个变量，其中，由于 &amp;&amp; 的优先级高于 ||，所以只要满足<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi><mi>s</mi><mi>e</mi><mi>r</mi><mi>n</mi><mi>a</mi><mi>m</mi><mi>e</mi><mo>=</mo><mo>=</mo><mo>=</mo><mtext>“</mtext><mi>a</mi><mi>d</mi><mi>m</mi><mi>i</mi><mi>n</mi><mtext>”和</mtext></mrow><annotation encoding="application/x-tex">username===“admin”和</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">u</span><span class="mord mathnormal">s</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">n</span><span class="mord mathnormal">a</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord">“</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mord mathnormal">m</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord">”</span><span class="mord cjk_fallback">和</span></span></span></span> code==‘admin’就可以拿到 flag，password 随便填写<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2016.40.58.png" alt=""></p><p>35.web133<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-13%2016.59.33.png" alt=""><br>在六个字符的限制下，写 flag.php 都不够用，在 wp 启发下，了解到构造 F= <code>$F</code> ;+ 其他命令的形式，由于字数限制， <code>$F</code> 肯定是会被读入的，但由于之前已经给 F 赋了值，所以被读入部分也可以视为 ``$F <code>;+其他命令</code> ，所有，会有其他命令被输入进去，通过 curl 外带，筛选 flag 带出<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2009.35.00.png" alt=""></p><p>36.web134<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.02.36.png" alt=""><br>@parse_str(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mrow></mrow><mi>S</mi></msub><mi>E</mi><mi>R</mi><mi>V</mi><mi>E</mi><mi>R</mi><msup><mo stretchy="false">[</mo><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mi>Q</mi><mi>U</mi><mi>E</mi><mi>R</mi><msub><mi>Y</mi><mi>S</mi></msub><mi>T</mi><mi>R</mi><mi>I</mi><mi>N</mi><mi>G</mi><mtext>’</mtext><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo separator="true">;</mo><mtext>查询</mtext><mi>u</mi><mi>r</mi><mi>l</mi><mtext>中</mtext><mo stretchy="false">?</mo><mtext>后面的键值对，并且解析字符串，将解析后的结果设为</mtext><mi>P</mi><mi>H</mi><mi>P</mi><mtext>的超级全局数组，再通过</mtext><mi>e</mi><mi>x</mi><mi>t</mi><mi>r</mi><mi>a</mi><mi>c</mi><mi>t</mi><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">_SERVER[&#x27;QUERY_STRING’]);查询url中?后面的键值对，并且解析字符串，将解析后的结果设为PHP的超级全局数组，再通过extract(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.001892em;vertical-align:-.25em"></span><span class="mord"><span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mopen"><span class="mopen">[</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.751892em"><span style="top:-3.063em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mord mathnormal">Q</span><span class="mord mathnormal" style="margin-right:.10903em">U</span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord"><span class="mord mathnormal" style="margin-right:.22222em">Y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:-.22222em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.05764em">S</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="mord mathnormal" style="margin-right:.07847em">I</span><span class="mord mathnormal" style="margin-right:.10903em">N</span><span class="mord mathnormal">G</span><span class="mord">’</span><span class="mclose">]</span><span class="mclose">)</span><span class="mpunct">;</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord cjk_fallback">查</span><span class="mord cjk_fallback">询</span><span class="mord mathnormal">u</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord cjk_fallback">中</span><span class="mclose">?</span><span class="mord cjk_fallback">后</span><span class="mord cjk_fallback">面</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">键</span><span class="mord cjk_fallback">值</span><span class="mord cjk_fallback">对</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">并</span><span class="mord cjk_fallback">且</span><span class="mord cjk_fallback">解</span><span class="mord cjk_fallback">析</span><span class="mord cjk_fallback">字</span><span class="mord cjk_fallback">符</span><span class="mord cjk_fallback">串</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">将</span><span class="mord cjk_fallback">解</span><span class="mord cjk_fallback">析</span><span class="mord cjk_fallback">后</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">结</span><span class="mord cjk_fallback">果</span><span class="mord cjk_fallback">设</span><span class="mord cjk_fallback">为</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord mathnormal" style="margin-right:.08125em">H</span><span class="mord mathnormal" style="margin-right:.13889em">P</span><span class="mord cjk_fallback">的</span><span class="mord cjk_fallback">超</span><span class="mord cjk_fallback">级</span><span class="mord cjk_fallback">全</span><span class="mord cjk_fallback">局</span><span class="mord cjk_fallback">数</span><span class="mord cjk_fallback">组</span><span class="mord cjk_fallback">，</span><span class="mord cjk_fallback">再</span><span class="mord cjk_fallback">通</span><span class="mord cjk_fallback">过</span><span class="mord mathnormal">e</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mopen">(</span></span></span></span>_POST); 将数组中的键作为 POST 的变量名，数组中的值作为 POST 的值，通过传入_POST [’key1‘]=36d 来绕过对于 GET 和 POST 的检查<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.09.37.png" alt=""></p><p>37.web135<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.22.17.png" alt=""><br>先前的 curl 外带失效了，还是自身引用自身，采用 cp 复制 flag.php 内容到 1.txt 文件中<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.28.27.png" alt=""><br>访问 1.txt<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.28.17.png" alt=""></p><p>38.web136<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.38.30.png" alt=""><br>用常规命令执行即可，但发现没有回显，运用 linux 的 tee 命令，将 ls 的内容写在文件 2 中<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.46.13.png" alt=""> &lt;!-- {&quot;width&quot;:373} --&gt;<br>发现 flag 文件 f149_15_h3r3，重复步骤抓取文件，拿到 flag<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2010.48.32.png" alt=""></p><p>39.web137<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2011.33.27.png" alt=""><br>涉及类的静态调用，直接用就行<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2011.33.10.png" alt=""></p><p>40.web138<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2014.33.42.png" alt=""><br>这题冒号的输入被限制了，使用数组的方式进行绕过<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2014.47.28.png" alt=""></p><p>41.web139<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2014.51.31.png" alt=""><br>和 web135 一样的题干，但是禁了 tee 命令，搬运了两个脚本来获取文件名和内容</p><p><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2015.05.26.png" alt="">&lt;!-- {&quot;width&quot;:523} --&gt;<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.01.59.png" alt="">&lt;!-- {&quot;width&quot;:465} --&gt;<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.03.27.png" alt="">&lt;!-- {&quot;width&quot;:523} --&gt;<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.03.39.png" alt="">&lt;!-- {&quot;width&quot;:501} --&gt;</p><p>42.web140<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.06.13.png" alt=""><br>看到最后一个 if 处是一个数字和字符串的弱比较，想要得到 True，intval 的返回值应该为 0<br>其中 f1 和 f2 都得是由字母数字构成的，而我们需要的<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mn>1</mn><mo stretchy="false">(</mo></mrow><annotation encoding="application/x-tex">f1(</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.10764em">f</span><span class="mord">1</span><span class="mopen">(</span></span></span></span>f2 ()) 的返回值应该为字母开头的字符串，空数组，0 或者是 False，所以可以通过构造上述几种结果，这里我选择了构造 FALSE<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.28.06.png" alt="">&lt;!-- {&quot;width&quot;:501} --&gt;<br>通过 system 函数的报错来拿到 flag</p><p>43.web141<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.33.38.png" alt=""><br>其中，v1 和 v2 随便用数字填，v3 根据 preg_match 来看可以是字母数字和下划线，在 eval 函数中绕过 return 可以添加运算符，而添加的运算符不会影响函数执行。由于 v3 的限制，可以通过取反来绕过</p><p><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2016.58.15.png" alt="">&lt;!-- {&quot;width&quot;:393} --&gt;<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-14%2017.10.23.png" alt="">&lt;!-- {&quot;width&quot;:594} --&gt;</p><p>44.web142<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2009.54.00.png" alt=""><br>主要解决 sleep 的问题，直接令 v1=0 即可，这样 d=0，查看源码拿到 flag<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2009.55.55.png" alt=""></p><p>45.web143<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2014.46.43.png" alt=""><br>和 web141 类似，v1 和 v2 是数字就行，v3 被过滤了字母数字，取反号和或都被过滤了，考虑用异或绕过，分号用？&gt; 代替，运算符中 + 和 - 也被过滤，用 * 即可，构造 payload：<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2010.53.20.png" alt="">&lt;!-- {&quot;width&quot;:526} --&gt;</p><p>46.web144<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2014.54.07.png" alt=""><br>v3 被限制成了一个字符，v2 也被 preg_match 限定了范围，v1 还是随便取数字就行，这里转换一下，将 v3 变为运算符，v2 来执行命令，此处我采用了或运算<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2015.04.51.png" alt=""></p><p>47.web145<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2015.17.29.png" alt=""><br>v1 和 v2 仍旧任意取数字，v3 使用取反来构造命令，了解到，return 还可以通过？构造判断的方式来绕过：eval (“return 1?system (‘tac f*’):1”)<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2015.26.25.png" alt=""></p><p>48.web146<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2016.22.24.png" alt=""><br>过滤了冒号，上题的绕过不适用了，改为 || 运算符<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2016.24.28.png" alt=""></p><p>49.web147<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2016.40.28.png" alt=""><br>这题的解法主要靠 create_fuction 这个函数，其主要思路就是：<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2010.11.58.png" alt=""><br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2010.02.29.png" alt=""></p><p>50.web148<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2010.15.15.png" alt=""><br>发现没有对 ^ 做过滤，考虑到异或绕过：<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2010.40.22.png" alt="">&lt;!-- {&quot;width&quot;:501} --&gt;</p><p>51.web149<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2010.45.17.png" alt=""><br>file_put_contents 能把字符串输入到文件中，能创建文件也能覆盖掉文件，不是 index.php 的文件都会被删除，将一句话木马直接写入 index.php 中<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2011.05.07.png" alt=""> &lt;!-- {&quot;width&quot;:473} --&gt;<img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2011.09.35.png" alt="">&lt;!-- {&quot;width&quot;:477} --&gt;</p><p>52.web150<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2011.13.20.png" alt=""><br>文件包含类型的题目，通过在 UA 处写一句话木马，然后包含 /var/log/nginx/access.log 就可以使用我们写的一句话了<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-15%2011.32.53.png" alt=""></p><p>53.web150_plus<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2011.13.20%202.png" alt=""><br>一样的题干，不过打了补丁，因为上题的解法为非预期解<br>构造？..CTFSHOW..=phpinfo 就可以看到 phpinfo 信息<br>原因是..CTFSHOW.. 解析变量成__CTFSHOW__然后进行了变量覆盖，因为 CTFSHOW 是类就会使用__autoload () 函数方法，去加载，因为等于 phpinfo 就会去加载 phpinfo<br><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2011.27.34.png" alt=""><img data-src="PHP%E7%89%B9%E6%80%A7/%E6%88%AA%E5%B1%8F2024-07-16%2011.27.46.png" alt=""></p></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-01-16 19:13:14" itemprop="dateModified" datetime="2025-01-16T19:13:14+08:00">2025-01-16</time></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Peppermint 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Peppermint 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Peppermint 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Peppermint <i class="ic i-at"><em>@</em></i>笔记小破站</li><li class="link"><strong>本文链接：</strong> <a href="http://example.com/2025/01/15/ctfshow/web-begin/PHP%E7%89%B9%E6%80%A7/" title="PHP特性">http://example.com/2025/01/15/ctfshow/web-begin/PHP特性/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/2025/01/13/hello-world/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;image.baidu.com&#x2F;search&#x2F;down?url&#x3D;https:&#x2F;&#x2F;tva4.sinaimg.cn&#x2F;mw690&#x2F;6833939bly1giclh0m9pdj20zk0m8hdt.jpg" title="Hello World"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i></span><h3>Hello World</h3></a></div><div class="item right"><a href="/2025/01/15/CTF/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024/" itemprop="url" rel="next" data-background-image="&#x2F;asserts&#x2F;geek.png" title="极客大挑战2024"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> CTF</span><h3>极客大挑战2024</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/2025/01/15/ctfshow/web-begin/PHP%E7%89%B9%E6%80%A7/" rel="bookmark" title="PHP特性">PHP特性</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Peppermint" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Peppermint</p><div class="description" itemprop="description"></div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">3</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">3</span> <span class="name">分类</span></a></div></nav><div class="social"></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>friends</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>links</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/2025/01/13/hello-world/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/2025/01/15/CTF/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/ctf/" title="分类于 CTF">CTF</a></div><span><a href="/2025/01/15/CTF/%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%982024/" title="极客大挑战2024">极客大挑战2024</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/ctfshow/" title="分类于 ctfshow">ctfshow</a> <i class="ic i-angle-right"></i> <a href="/categories/ctfshow/web%E5%85%A5%E9%97%A8/" title="分类于 web入门">web入门</a></div><span><a href="/2025/01/15/ctfshow/web-begin/PHP%E7%89%B9%E6%80%A7/" title="PHP特性">PHP特性</a></span></li><li class="item"><div class="breadcrumb"></div><span><a href="/2025/01/13/hello-world/" title="Hello World">Hello World</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Peppermint @ Peppermintの小窝</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2025/01/15/ctfshow/web-begin/PHP特性/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->